import type { NextPage } from 'next'
import Head from 'next/head'
import Image from 'next/image'
import Link from 'next/link'
import { useEffect, useState } from 'react'
import styles from '../styles/Home.module.css'
import Abiturs from './component/abiturs'
import { Specialization } from '@prisma/client'

const Admin: NextPage = () => {
    const [methodEducation, setMethodEducation] = useState('');
    const [specialization_first, setSpecializationFirst] = useState('')
    const handleChange=async (e: { target: { value: any } })=>{
        await setMethodEducation(e.target.value);
        await console.log(methodEducation)
    }
    async function Admin() {
        document.location.href= await "/"
    }
    const ahandleSubmit = () => {
        const val = document.getElementById('filtersos')?.value
        const valoch = document.getElementById('filtersosoch')?.value
        setSpecializationFirst(val + "_"+valoch)
        CreateEX(val, valoch)
    }
    const ahandleSubmitmod = () => {
        const val = document.getElementById('filtersosmod')?.value
        const valoch = document.getElementById('filtersosochmod')?.value
        const valcat = document.getElementById('filtersoscatmod')?.value
        setSpecializationFirst(val + "_"+valoch + "_" + valcat)
        CreateEXmod(val, valoch, valcat)
    }
    async function CreateEX(val: any, valoch: any) {
        // GET request using fetch with async/await
        const response = await fetch('/api/xlsx', {
            body: JSON.stringify({specialization_first: val, form_education: valoch}),
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'POST'
        })
        const datas = await response.json();
        console.log(datas)
        console.log(specialization_first)
    }
    async function CreateEXmod(val: any, valoch: any, valcat: any) {
        // GET request using fetch with async/await
        const response = await fetch('/api/xlsxmod', {
            body: JSON.stringify({specialization_first: val, form_education: valoch, education_complete_category: valcat}),
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'POST'
        })
        const datas = await response.json();
        console.log(datas)
        console.log(specialization_first)
    }
    async function GenAll() {
        // GET request using fetch with async/await
        const response = await fetch('/api/xlsxall', {
            body: JSON.stringify({status: 'request'}),
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'POST'
        })
        alert('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–º–ø–∞ –¥–∞–Ω–Ω—ã—Ö –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤')
        const datas = await response.json();
        console.log(datas)
    }
    async function GenAllFin() {
        // GET request using fetch with async/await
        const response = await fetch('/api/xlsxfin', {
            body: JSON.stringify({status: 'request'}),
            headers: {
                'Content-Type': 'application/json'
            },
            method: 'POST'
        })
        alert('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–º–ø–∞ –¥–∞–Ω–Ω—ã—Ö –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤')
        const datas = await response.json();
        console.log(datas)
    }
    const [specializationsList, setSpecializationsList] = useState<Specialization[] | null>(null);
    const hanleGetSpec = async () => {
        const res = await fetch('/api/specializations');
        const data = await res.json();
        setSpecializationsList(data)
    };
    useEffect(() => {
        hanleGetSpec()
    }, []);
    return (
        <div className={styles.container}>
        <Head>
            <title>Create Next App</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/favicon.ico" />
        </Head>

        <main>
            <h1 className={styles.title}>
                <label>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ </label>
                <Link href="/configure" className={styles.card} rel="noopener noreferrer" title='–ú–µ–Ω—é –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º–∏'>‚öô</Link>
                <Link href="/" className={styles.card} rel="noopener noreferrer" title='–ù–∞ –≥–ª–∞–≤–Ω—É—é'>üè†</Link>
            </h1>
            <br/>
            {/** 
            <label className={styles.label}>–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:</label> 
                        <select name="specialization_first" id="filtersos" onChange={ahandleSubmit}>
                            <option value='–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–ø–ª–µ–∫—Å—ã'>–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–ø–ª–µ–∫—Å—ã</option>
                            <option value='–ú–æ–Ω—Ç–∞–∂ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ —Å–∏—Å—Ç–µ–º –≥–∞–∑–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è'>–ú–æ–Ω—Ç–∞–∂ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ —Å–∏—Å—Ç–µ–º –≥–∞–∑–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è</option>
                            <option value='–ú–æ–Ω—Ç–∞–∂, –Ω–∞–ª–∞–¥–∫–∞ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏—Ö –∑–¥–∞–Ω–∏–π'>–ú–æ–Ω—Ç–∞–∂, –Ω–∞–ª–∞–¥–∫–∞ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏—Ö –∑–¥–∞–Ω–∏–π</option>
                            <option value='–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ'>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
                            <option value='–ü–æ—á—Ç–æ–≤–∞—è —Å–≤—è–∑—å'>–ü–æ—á—Ç–æ–≤–∞—è —Å–≤—è–∑—å</option>
                            <option value='–¢–µ–ø–ª–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ –∏ —Ç–µ–ø–ª–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ'>–¢–µ–ø–ª–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ –∏ —Ç–µ–ø–ª–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
                            <option value='–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π'>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π</option>
                            <option value='–ü—Ä–∞–≤–æ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è'>–ü—Ä–∞–≤–æ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</option>
                            <option value='–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)'>–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)</option>
                            <option value='–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω–∏–∫ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ç–µ–π –∏ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è'>–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω–∏–∫ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ç–µ–π –∏ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</option>
                            <option value='–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏–π –∏ —Å–µ—Ç–µ–π'>–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏–π –∏ —Å–µ—Ç–µ–π</option>
                            <option value='–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä –ø–æ —Ä–µ–º–æ–Ω—Ç—É –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)'>–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä –ø–æ —Ä–µ–º–æ–Ω—Ç—É –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)</option>
                            <option value='–û–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ—Ñ—Ç–µ–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏'>–û–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ—Ñ—Ç–µ–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏</option>
                            <option value='–ü—Ä–æ–¥–∞–≤–µ—Ü, –∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä-–∫–∞—Å—Å–∏—Ä'>–ü—Ä–æ–¥–∞–≤–µ—Ü, –∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä-–∫–∞—Å—Å–∏—Ä</option>
                            <option value='–ú–∞—Å—Ç–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ-–∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–±–æ—Ä–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏'>–ú–∞—Å—Ç–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ-–∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–±–æ—Ä–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏</option>
                            <option value='–õ–∞–±–æ—Ä–∞–Ω—Ç-—ç–∫–æ–ª–æ–≥'>–õ–∞–±–æ—Ä–∞–Ω—Ç-—ç–∫–æ–ª–æ–≥</option>
                            <option value='–ù–∞–ª–∞–¥—á–∏–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π'>–ù–∞–ª–∞–¥—á–∏–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π</option>
                            <option value='–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç —Å–∏—Å—Ç–µ–º –∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π'>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç —Å–∏—Å—Ç–µ–º –∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</option>
                        </select>
                        <label className={styles.label}>–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è:</label> 
                        <select name="form_education" id="filtersosoch" onChange={ahandleSubmit}>
                            <option value='–ó–ê–û–ß–ù–û–ô'>–ó–ê–û–ß–ù–ê–Ø</option>
                            <option value='–û–ß–ù–û–ô'>–û–ß–ù–ê–Ø</option>
                        </select>
                            <a target="_blank" href={`./tables/${specialization_first}.xlsx`} download>
                                <Link href={`./tables/${specialization_first}.xlsx`} target="_blank">
                                <button>–°–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø—ã</button></Link></a>
                                <button onClick={Admin}>–ù–∞ –≥–ª–∞–≤–Ω—É—é</button><br/>
                                */}
            
            <label>–ù–∞–∂–º–∏—Ç–µ –≤–Ω–∞—á–∞–ª–µ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞, –∏ —Ç–æ–ª—å–∫–æ –∑–∞—Ç–µ–º –û—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º!</label>
            <button className={styles.bita} onClick={GenAll}>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞</button>
                                <a target="_blank" href={`./tables/full.xlsx`} download>
                                <Link href={`./tables/full.xlsx`} target="_blank">
                                <button className={styles.bita}>–û—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º</button></Link></a><br/>
            
            <label>–ù–∞–∂–º–∏—Ç–µ –≤–Ω–∞—á–∞–ª–µ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –§–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞, –∏ —Ç–æ–ª—å–∫–æ –∑–∞—Ç–µ–º –§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º!</label>
            <button className={styles.bita2} onClick={GenAllFin}>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –§–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞</button>
                                <a target="_blank" href={`./tables/fullfin.xlsx`} download>
                                <Link href={`./tables/fullfin.xlsx`} target="_blank">
                                <button className={styles.bita2}>–§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º</button></Link></a><br/>

            <label className={styles.label}>–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:</label> 
                <select name="specialization_first" id="filtersosmod" onChange={ahandleSubmitmod}>
                    { specializationsList?.map(specialization => ( <option key={specialization.id} value={specialization.name}>{specialization.name}</option> )) }
                </select>
                        {/*
                        <select name="specialization_first" id="filtersosmod" onChange={ahandleSubmitmod}>
                            <option value='–ü—Ä–∞–≤–æ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è'>–ü—Ä–∞–≤–æ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</option>
                            <option value='–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)'>–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç (–ø–æ –æ—Ç—Ä–∞—Å–ª—è–º)</option>
                        </select>
                        */}
                        <label className={styles.label}>–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è:</label> 
                        <select name="form_education" id="filtersosochmod" onChange={ahandleSubmitmod}>
                            <option value='–ó–ê–û–ß–ù–û–ô'>–ó–ê–û–ß–ù–ê–Ø</option>
                            <option value='–û–ß–ù–û–ô'>–û–ß–ù–ê–Ø</option>
                        </select>
                        <label className={styles.label}>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:</label> 
                        <select name="education_complete_category" id="filtersoscatmod" onChange={ahandleSubmitmod}>
                            <option value='–°–†–ï–î–ù–ï–ï –û–ë–©–ï–ï'>–°–†–ï–î–ù–ï–ï –û–ë–©–ï–ï - 11 –ö–õ–ê–°–°–û–í</option>
                            <option value='–û–°–ù–û–í–ù–û–ï –û–ë–©–ï–ï'>–û–°–ù–û–í–ù–û–ï –û–ë–©–ï–ï - 9 –ö–õ–ê–°–°–û–í</option>
                        </select>
                            <a target="_blank" href={`./tables/${specialization_first}.xlsx`} download>
                                <Link href={`./tables/${specialization_first}.xlsx`} target="_blank">
                                <button>–°–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø—ã</button></Link></a>
            <div className={styles.grid}>
            <div className={styles.card}>
                <Abiturs/>
            </div>
            </div>
        </main>

        <footer className={styles.footer}>
        <div className={styles.code} onClick={Admin}>–ü—Ä–∏–µ–º–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è –ö–ì–ë –ü–û–£ –•–ö–û–¢–°–û 2022</div>
        </footer>
        </div>
    )
}

export default Admin
